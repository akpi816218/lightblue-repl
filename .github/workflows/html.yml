name: Path lister HTML
on: [push]
jobs:
  list:
    name: Path lister HTML
    runs-on: ubuntu-latest
    steps:
      - name: Set up Python 3.7
        uses: actions/setup-python@v1
        with:
          python-version: "3.7"

      - uses: actions/checkout@v1

      - name: Fetch action
        id: pl
        uses: Rishabh510/Path-lister-action@master
        with:
          path: "./"
          type: ".html"

      - name: Output results
        run: |
          echo "Found ${{ steps.pl.outputs.path_count }} file(s) with this extension:"
          echo "[" >> ./list.txt
          for i in ${{ steps.pl.outputs.paths }}; do
          echo $i
          echo "'${i}', " >> ./list.txt
          done
          echo "];" >> ./list.txt

      - name: Commit files
          id: commit
          run: |
            git config --local user.email "action@github.com"
            git config --local user.name "github-actions"
            git add --all
            if [-z "$(git status --porcelain)"]; then
              echo "::set-output name=push::false"
            else
              git commit -m "Add changes" -a
              echo "::set-output name=push::true"
            fi
          shell: bash
        - name: Push changes
          if: steps.commit.outputs.push == 'true'
          uses: ad-m/github-push-action@master
          with:
            github_token: ${{ secrets.GITHUB_TOKEN }}